define(["require","exports","knockout","jquery","ojs/ojoffcanvas","ojs/ojcontext","ojL10n!./resources/nls/oj-dbt-panel-slider-strings","ojs/ojknockout"],(function(require,e,s,t,i,o,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=class{constructor(e){this.isSliderOpen=s.observable(!1),this.sliderClass=s.observable("oj-panel oj-offcanvas-overlay-shadow slider-outer-frame oj-offcanvas-end oj-dbt-panel-slider-medium-width"),this.title=s.observable(""),this.onCancel=s.observable(),this.onHelp=s.observable(),this.cancelLabel=s.observable(""),this.helpLabel=s.observable(""),this.buttons=s.observableArray(),this.isJet8=s.observable(!0),this.isZIndex=s.observable(!1),this.titleIcon=s.observable(),this.errorMessage=s.observable(""),this.clearErrorMessageLabel=s.observable(""),this.isTopButtonsStyleLink=s.observable(!1),this.isCloseOnEscape=!0,this.hideScroll=e=>{var s,i;this.isSliderOpen(e),this.scrollContainerId&&(e?null===(s=t("#"+this.scrollContainerId))||void 0===s||s.addClass("oj-dbt-panel-slider-hide-scroll"):null===(i=t("#"+this.scrollContainerId))||void 0===i||i.removeClass("oj-dbt-panel-slider-hide-scroll"))},this.sendStateChangeEvent=e=>{this.composite.dispatchEvent(new CustomEvent("sliderStateChanged",{bubbles:!0,detail:{value:e}}))},this.squeezeResize=()=>{const e=t("#oj-dbt-main-page-slot"),s=t("#oj-dbt-drawer-id");e.css({width:`calc(100vw - ${s.outerWidth()}px)`,position:"relative"})},this.setSqueezeMode=()=>{const e=t("#oj-dbt-drawer-id"),s=t("#oj-dbt-main-page-slot");if(!e||!s)return;const i=e.outerWidth();s.css({width:`calc(100vw - ${i}px)`,position:"relative",left:i+"px"}),t(window)&&t(window).resize(this.squeezeResize)},this.closeOnEscape=e=>{"Escape"===e.key&&this.closeSlider()},this.openSlider=e=>{"squeeze"!==(null==e?void 0:e.displayMode)&&this.hideScroll(!0),this.errorMessage("");let s=("left"===(null==e?void 0:e.orientation)?"oj-offcanvas-start":"oj-offcanvas-end")+" "+((null==e?void 0:e.cssWidthClass)?e.cssWidthClass:"oj-dbt-panel-slider-medium-width-auto");s+=" oj-panel oj-offcanvas-overlay-shadow slider-outer-frame";const o=document.documentElement;this.isCloseOnEscape=void 0===(null==e?void 0:e.closeOnEscape)||(null==e?void 0:e.closeOnEscape),this.isCloseOnEscape&&o.addEventListener("keydown",this.closeOnEscape),(null==e?void 0:e.zIndex)?(o.style.setProperty("--oj-dbt-panel-slider-glass-z-index",e.zIndex+""),o.style.setProperty("--oj-dbt-panel-slider-content-z-index",e.zIndex+10+""),s+=" oj-dbt-panel-slider-z-index",this.isZIndex(!0)):(o.style.setProperty("--oj-dbt-panel-slider-glass-z-index","0"),o.style.setProperty("--oj-dbt-panel-slider-content-z-index","0"),this.isZIndex(!1)),this.titleIcon(null==e?void 0:e.titleIcon),this.sliderClass(s),this.title((null==e?void 0:e.title)||""),this.onCancel(null==e?void 0:e.onCancel),this.onHelp(null==e?void 0:e.onHelp),this.isTopButtonsStyleLink("link"===(null==e?void 0:e.topButtonStyle)),this.buttons(null==e?void 0:e.buttons),this.setupButtons();const n=(null==e?void 0:e.displayMode)||"overlay";let l="modal";(null==e?void 0:e.modality)?l=e.modality:"squeeze"===n&&(l="modeless");const d=i.open({displayMode:"squeeze"===n?"push":n,selector:`#${this.uniqueId} > div > div > #oj-dbt-drawer-id`,content:`#${this.uniqueId} > div > div > #oj-dbt-main-page-slot`,modality:l,autoDismiss:"none"});return d.then((e=>{e&&this.sendStateChangeEvent("opened")})),t(window).off("resize",this.squeezeResize),"squeeze"===n&&setTimeout(this.setSqueezeMode,10),d},this.closeSlider=()=>{const e=document.documentElement;this.isCloseOnEscape&&e.removeEventListener("keydown",this.closeOnEscape),t("#oj-dbt-main-page-slot")&&t(window)&&(t("#oj-dbt-main-page-slot").css({width:"initial",position:"initial",left:"initial"}),t(window).off("resize",this.squeezeResize));const s=i.close({selector:`#${this.uniqueId} > div > div > #oj-dbt-drawer-id`});return s.then((e=>{e&&(this.sendStateChangeEvent("closed"),this.hideScroll(!1))})),s},this.updateSliderButtons=e=>{if(!e||!this.buttons.peek()||this.buttons.peek().length<1)return;let s=!1;const t=this.buttons.peek().map((t=>{const i=e[t.id];return i&&(void 0!==i.disabled&&(t.disabled!=i.disabled&&(s=!0),t.disabled=i.disabled),void 0!==i.hidden&&(t.hidden!=i.hidden&&(s=!0),t.hidden=i.hidden)),Object.assign({},t)}));s&&this.buttons(t)},this.setErrorMessage=e=>{this.errorMessage(e)},this.onClearErrorMessage=()=>{this.errorMessage("")};const l=o.getContext(e.element).getBusyContext();this.uniqueId=e.uniqueId;const{scrollContainerId:d,sliderHeight:r}=e.properties;this.busyResolve=l.addBusyState({description:""}),this.composite=e.element,this.scrollContainerId=d,n&&n.ojdbtPanelSlider&&(this.cancelLabel(n.ojdbtPanelSlider.close),this.clearErrorMessageLabel(n.ojdbtPanelSlider.clearErrorMessage),this.helpLabel(n.ojdbtPanelSlider.help));const a=document.documentElement;if(r?a.style.setProperty("--oj-dbt-panel-slider-height",r):a.style.setProperty("--oj-dbt-panel-slider-height","100vh"),"undefined"!=typeof oj&&oj&&oj.version){const e=oj.version.startsWith("8.");this.isJet8(e)}this.busyResolve()}getClassName(e){return e?e.toLowerCase():""}setupButtons(){if(!this.buttons()||this.buttons().length<1)return;void 0===this.buttons()[0].style&&(this.buttons()[0].style="PRIMARY");const e=this.buttons().map((e=>Object.assign({},e)));this.buttons(e)}activated(e){}connected(e){}bindingsApplied(e){}disconnectd(e){}propertyChanged(e){}}}));